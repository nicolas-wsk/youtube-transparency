<!DOCTYPE html>

<head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width">
      <title>AlgoTransparency</title>
      <link rel="icon" type="image/png" href="favicon.png" />
      <meta property="og:url" content="http://algotransparency.org/" />
      <meta property="og:type" content="article" />
      <meta property="og:title" content="YouTube recommended videos" />
      <meta property="og:image" content="/images/youtube-map-mini.jpg" />
      <meta property="og:image:type" content="image/jpg" />
      <meta property="og:description" content="AlgoTransparency studied the impact of the YouTube recommendation algorithm." />
      <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

      <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js"></script>                       
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>-->
      <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"><!--
      <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css">
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/js/bootstrap-datetimepicker.min.js"></script> -->

      <!--  jQuery -->
      <script type="text/javascript" src="//code.jquery.com/jquery-1.11.3.min.js"></script>

      <!-- Isolated Version of Bootstrap, not needed if your site already uses Bootstrap -->
      <link rel="stylesheet" href="//formden.com/static/cdn/bootstrap-iso.css" />

      <!-- Bootstrap Date-Picker Plugin -->
      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/js/bootstrap-datepicker.min.js"></script>
      <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/css/bootstrap-datepicker3.css"/>

      <link href="//fonts.googleapis.com/css?family=Roboto:400,500,700" rel="stylesheet">
      <link rel="stylesheet" href="/app.css">
      <script src="/app.js"></script>
      <script src="https://code.highcharts.com/highcharts.js"></script>
      <script src="https://code.highcharts.com/highcharts-more.js"></script>
      <script src="https://code.highcharts.com/modules/exporting.js"></script>
      <script src="https://code.highcharts.com/modules/export-data.js"></script>
      
      <script type="text/javascript">
            (function (e, t) {
                  var n = e.amplitude || { _q: [], _iq: {} }; var r = t.createElement("script")
                        ; r.type = "text/javascript"; r.async = true
                        ; r.src = "https://cdn.amplitude.com/libs/amplitude-4.1.0-min.gz.js"
                        ; r.onload = function () {
                              if (e.amplitude.runQueuedFunctions) {
                                    e.amplitude.runQueuedFunctions()
                              } else {
                                    console.log("[Amplitude] Error: could not load SDK")
                              }
                        }
                        ; var i = t.getElementsByTagName("script")[0]; i.parentNode.insertBefore(r, i)
                        ; function s(e, t) {
                        e.prototype[t] = function () {
                              this._q.push([t].concat(Array.prototype.slice.call(arguments, 0))); return this
                        }
                        }
                  var o = function () { this._q = []; return this }
                        ; var a = ["add", "append", "clearAll", "prepend", "set", "setOnce", "unset"]
                        ; for (var u = 0; u < a.length; u++) { s(o, a[u]) } n.Identify = o; var c = function () {
                        this._q = []
                              ; return this
                        }
                        ; var l = ["setProductId", "setQuantity", "setPrice", "setRevenueType", "setEventProperties"]
                        ; for (var p = 0; p < l.length; p++) { s(c, l[p]) } n.Revenue = c
                        ; var d = ["init", "logEvent", "logRevenue", "setUserId", "setUserProperties", "setOptOut", "setVersionName", "setDomain", "setDeviceId", "setGlobalUserProperties", "identify", "clearUserProperties", "setGroup", "logRevenueV2", "regenerateDeviceId", "logEventWithTimestamp", "logEventWithGroups", "setSessionId"]
                        ; function v(e) {
                              function t(t) {
                              e[t] = function () {
                                    e._q.push([t].concat(Array.prototype.slice.call(arguments, 0)))
                              }
                              }
                              for (var n = 0; n < d.length; n++) { t(d[n]) }
                        } v(n); n.getInstance = function (e) {
                              e = (!e || e.length === 0 ? "$default_instance" : e).toLowerCase()
                                    ; if (!n._iq.hasOwnProperty(e)) { n._iq[e] = { _q: [] }; v(n._iq[e]) } return n._iq[e]
                        }
                        ; e.amplitude = n
            })(window, document);

            amplitude.getInstance().init("ac83dc709767bb0f32724a7edff4e715");
            amplitude.getInstance().logEvent('Index Loaded');
      </script>
</head>

<body>
      <section class="hero is-small">
            <!-- Hero header: will stick at the top -->
            <div class="hero-head">
                  <header class="nav nav-first">
                        <div class="nav-bar">
                              <div class="nav-left">
                                    <a class="nav-item" href="index.html">
                                          <strong>AlgoTransparency</strong>
                                    </a>
                              </div>
                              <span class="nav-toggle">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                              </span>
                              <div class="nav-right nav-menu">
                                    <a class="nav-item" href="/en/science.html">
                                          Themes
                                    </a>
                                    <a class="nav-item" href="/youtube.html">
                                          YouTube Map
                                    </a>
                                    <a class="nav-item showIntro">
                                          Watch intro
                                    </a>
                                    <a class="nav-item" href="/methodology.html">
                                          About
                                    </a>
                                    <a class="nav-item" href="/en/press.html">
                                          Media Coverage
                                    </a>
                                    <div class="twitter-btn">
                                          <a href="https://twitter.com/helloalgo?ref_src=twsrc%5Etfw" class="twitter-follow-button"
                                                data-size="large" data-show-screen-name="false" data-lang="en" data-show-count="false">Follow @helloalgo</a>
                                          <script async src="https://platform.twitter.com/widgets.js"
                                                charset="utf-8"></script>
                                    </div>
                              </div>
                        </div>
                  </header>
                  <div class="search-space">
                              <div class="container column is-8 is-offset-2">
                                    <div class="info-title">
                                          <div class="info-title-in col-xs-12">
                                                Graphs to understand YouTube <br><br>
                                          </div>
                                    </div>
                              </div>
                  </div>
            </div>
      </section>
      <div id="containers">
      </div>
      <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-58ea64fc4724e90a"></script>

      <script>

            (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                  (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date(); a = s.createElement(o),
                  m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-97331997-1', 'auto');
            ga('send', 'pageview');

var results_shown = 0;

function getUrlVar(key) {
   const result = new RegExp(key + '=([^&]*)', 'i').exec(window.location.search);
   return (result && unescape(result[1])) || '';
}


function changeUrlParam(param, value) {
   const currentURL = window.location.href + '&';
   const change = new RegExp('(' + param + ')=(.*)&', 'g');
   const newURL = currentURL.replace(change, '$1=' + value + '&');

   if (getURLParameter(param) !== null) {
      try {
         window.history.replaceState('', '', newURL.slice(0, -1));
      } catch (err) {
         console.err(err);
      }
   } else {
      const currURL = window.location.href;
      if (currURL.indexOf('?') !== -1) {
         window.history.replaceState(
        '',
        '',
        currentURL.slice(0, -1) + '&' + param + '=' + value
      );
      } else {
         window.history.replaceState(
        '',
        '',
        currentURL.slice(0, -1) + '?' + param + '=' + value
      );
      }
   }
}

function getURLParameter(name) {
   return (
    decodeURIComponent(
      (new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(
        location.search
      ) || [, ''])[1]
        .replace(/\+/g, '%20')
    ) || null
   );
}

let jsonLocal = {};
const jsonThemeLocal = {};


function number_format(number, decimals, dec_point, thousands_sep) {
    // http://kevin.vanzonneveld.net
    // +   original by: Jonas Raoni Soares Silva (http://www.jsfromhell.com)
    // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
    // +     bugfix by: Michael White (http://getsprink.com)
    // +     bugfix by: Benjamin Lupton
    // +     bugfix by: Allan Jensen (http://www.winternet.no)
    // +    revised by: Jonas Raoni Soares Silva (http://www.jsfromhell.com)
    // +     bugfix by: Howard Yeend
    // +    revised by: Luke Smith (http://lucassmith.name)
    // +     bugfix by: Diogo Resende
    // +     bugfix by: Rival
    // +      input by: Kheang Hok Chin (http://www.distantia.ca/)
    // +   improved by: davook
    // +   improved by: Brett Zamir (http://brett-zamir.me)
    // +      input by: Jay Klehr
    // +   improved by: Brett Zamir (http://brett-zamir.me)
    // +      input by: Amir Habibi (http://www.residence-mixte.com/)
    // +     bugfix by: Brett Zamir (http://brett-zamir.me)
    // +   improved by: Theriault
    // +   improved by: Drew Noakes
    // *     example 1: number_format(1234.56);
    // *     returns 1: '1,235'
    // *     example 2: number_format(1234.56, 2, ',', ' ');
    // *     returns 2: '1 234,56'
    // *     example 3: number_format(1234.5678, 2, '.', '');
    // *     returns 3: '1234.57'
    // *     example 4: number_format(67, 2, ',', '.');
    // *     returns 4: '67,00'
    // *     example 5: number_format(1000);
    // *     returns 5: '1,000'
    // *     example 6: number_format(67.311, 2);
    // *     returns 6: '67.31'
    // *     example 7: number_format(1000.55, 1);
    // *     returns 7: '1,000.6'
    // *     example 8: number_format(67000, 5, ',', '.');
    // *     returns 8: '67.000,00000'
    // *     example 9: number_format(0.9, 0);
    // *     returns 9: '1'
    // *    example 10: number_format('1.20', 2);
    // *    returns 10: '1.20'
    // *    example 11: number_format('1.20', 4);
    // *    returns 11: '1.2000'
    // *    example 12: number_format('1.2000', 3);
    // *    returns 12: '1.200'
    var n = !isFinite(+number) ? 0 : +number, 
        prec = !isFinite(+decimals) ? 0 : Math.abs(decimals),
        sep = (typeof thousands_sep === 'undefined') ? ',' : thousands_sep,
        dec = (typeof dec_point === 'undefined') ? '.' : dec_point,
        toFixedFix = function (n, prec) {
            // Fix for IE parseFloat(0.55).toFixed(0) = 0;
            var k = Math.pow(10, prec);
            return Math.round(n * k) / k;
        },
        s = (prec ? toFixedFix(n, prec) : Math.round(n)).toString().split('.');
    if (s[0].length > 3) {
        s[0] = s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g, sep);
    }
    if ((s[1] || '').length < prec) {
        s[1] = s[1] || '';
        s[1] += new Array(prec - s[1].length + 1).join('0');
    }
    return s.join(dec);
}

function print_item(id){
      console.log('https://www.youtube.com/watch?v=' + id)
}

function create_bubble_chart(container_id, graph_data){

$('#containers').append(`<div id="${container_id}" style="height: 600px; min-width: 310px; max-width: 900px; margin: 0 auto"></div>`)

Highcharts.chart(container_id, {

chart: {
type: 'bubble',
plotBorderWidth: 1,
zoomType: 'xy'
},

legend: {
enabled: false
},

title: {
text: 'Views, recommendations, volume for given keywords'
},

xAxis: {
gridLineWidth: 1,
title: {
      text: 'Million Views'
},
labels: {
      format: '{value}'
},
},

yAxis: {
startOnTick: false,
endOnTick: false,
title: {
      text: 'Million Recommendations'
},
labels: {
      format: '{value}'
},
maxPadding: 0.2,
},

tooltip: {
useHTML: true,
headerFormat: '<table>',
pointFormat: '<tr><th colspan="2"><h3>{point.country}</h3></th></tr>' +
      '<tr><th>Observed Million Views:</th><td>{point.x}</td></tr>' +
      '<tr><th>Observed Million Recommendations:</th><td>{point.y}</td></tr>' +
      '<tr><th>Number of videos:</th><td>{point.z}</td></tr>',
footerFormat: '</table>',
followPointer: true
},

plotOptions: {
series: {
      dataLabels: {
            enabled: true,
            format: '{point.name}'
      }
}
},

series: [{
data: graph_data
}]
});
}


function create_bar_chart(container_id, name, title, legend, values) {

$('#containers').append(`<div id="${container_id}" style="height: 600px; min-width: 310px; max-width: 900px; margin: 0 auto"></div>`)

Highcharts.chart(container_id, {
    chart: {
        type: 'bar'
    },
    title: {
        text: title
    },
    xAxis: {
        categories: legend,
        title: {
            text: null
        }
    },
    yAxis: {
        min: 0,
        title: {
            text: 'Legend',
            align: 'high'
        },
        labels: {
            overflow: 'justify'
        }
    },
    tooltip: {
        valueSuffix: ''
    },
    plotOptions: {
        bar: {
            dataLabels: {
                enabled: true
            }
        }
    },
    legend: {
        layout: 'vertical',
        align: 'right',
        verticalAlign: 'top',
        x: -40,
        y: 80,
        floating: true,
        borderWidth: 1,
        backgroundColor: ((Highcharts.theme && Highcharts.theme.legendBackgroundColor) || '#FFFFFF'),
        shadow: true
    },
    credits: {
        enabled: false
    },
    series: [{
        name: name,
        data: values
    }]
});
}
// data['recos_per_view']

$(document).ready(function() {
      $.get('/data/info/graphs.json', function(data) {
            create_bar_chart('conta', data['keywords'], data['recos_to_occs'])
            create_bar_chart('conta1', data['keywords'], data['recos_to_views'])
      });
})

function approximateViews(list, idx) {
      var previous_val=0;
      var previous_idx=-1;
      var next_val=0;
      var next_idx=-1;
      for (var i=0; i < list.length; i++){
            if (i<idx && list[i]>0) {
                  previous_val=list[i]
                  console.log(' P V '+ previous_val)
                  previous_idx=i
            }
            if (i>idx && list[i]>0) {
                  next_val=list[i]
                  next_idx=i
                  break;
            }
      }(i)
      if (previous_idx === -1 || next_idx === -1) {
            return 0
      }
      return Math.round(previous_val) + Math.round(((idx-previous_idx)*(next_val-previous_val)/(next_idx-previous_idx)))
}


function addSinkHoles(init, end) {
  // Compute the sinkholes
  var counts = {}
  var videos_info = {}
  for (var key in jsonLocal) {
    console.log(key)
    // check if the property/key is defined in the object itself, not in parent
    if (jsonLocal.hasOwnProperty(key)) {
        jsonLocal[key].filter((item) => item.likes !== -1).forEach((item, index) => {
        counts[item.id] = (counts[item.id] || 0) + 1;
        videos_info[item.id] = item
      })
    }
  }
  var sorted_counts = Object.keys(counts).map(function(key) {
    return [key, counts[key]];
  });

  // Sort the array based on the second element
  sorted_counts.sort(function(first, second) {
      return second[1] - first[1];
  });

  var filtered_vids = jsonLocal[key].filter((item) => item.likes !== -1).map(function(item) {
    return [item.id, 0];
  })

  if (filtered_vids.length == 0) {
      $('.sink-videos').append(
    `
      <div class="sinkhole">No data available for that date and keywords. Please select a different date or keywords.<div>
    `
      )
  }
  console.log('Number of stuff')
  console.log(filtered_vids)

  // Computing the global max channels for all items   
  let max_chans = 0;
  filtered_vids.forEach((elem) => {
    var item = videos_info[elem[0]];
      for (var i=0;i<item.chan_history.length;i++) {
            if (item.chan_history[i] > max_chans) {
                  max_chans = item.chan_history[i]
            }
      }
  })
  const max_recos = 1000000

  filtered_vids.slice(init, end).forEach((elem, index) => {
    console.log('Elem')
    var item = videos_info[elem[0]];
    const views = item.views > 0 ? `${number_format(item.views)} views` : '';
    const multiplicator = item['nb_chans_rec'];
    const obs_recos = item['observed_recos']
    const mult = multiplicator ? `
          <div class="mult right" data-balloon-length="large" data-balloon="YouTube recommended this video from ${multiplicator} different channels"><div class="mult-text"> Number of channels recommending it: </div><div class="mult-yy"><strong>${Math.round(multiplicator * 10) / 10} </strong></div>
          <div class="right" data-balloon-length="large" data-balloon="The algorithm recommended this video at least ${number_format(obs_recos)} times, and probably much more"><div class="mult-text"> Recommendations: </div><div class="mult-yy"><strong>${number_format(obs_recos)}</strong</div>
          </div>`
      : '';
      var max_local_chans=0;
      var days_ago=0;
      for (var i=0;i<item.chan_history.length;i++) {
            if (item.chan_history[i] > max_local_chans) {
                  max_local_chans = item.chan_history[i]
                  days_ago = item.chan_history.length - i
            }
      }

    if (item.views > 0 && multiplicator > 0) {
      var like_comment = ''
      if (item.likes > 10 && item.dislikes >10) {
            var ratio = item.likes / (item.likes + item.dislikes)
            var ratio_v = Math.floor((1-ratio)*100)
            var warnings = ''
            for (var i=0; i < Math.floor((1-ratio) * 10); i++) {
                  warnings += `⚠️`
            }
            like_comment = `<div style="color:#DD2726;font-weight:bold;margin-top:15px;"> ${ratio_v} % dislikes ${warnings} </div>`
      }    

      $('.sink-videos').append(
      `
          <div style="font-size: 25px;font-weight: bold;color:#DD2726;margin-left:20px;margin-top:15px;">${index + results_shown-10 +1})</div>
          <div class="box">
          <article class="media">
              <figure class="media-left level">
                <a href="https://www.youtube.com/watch?v=${item.id}" target="_blank">
                    <div class="is-inline-block level-item">
                      <img class="image" width="170px" src="https://img.youtube.com/vi/${item.id}/hqdefault.jpg">
                    </div>
                </a>
              </figure>
              <div class="media-content">
                <div class="content">
                    <a class="video-title" href="https://www.youtube.com/watch?v=${item.id}" target="_blank">${item.title}</a>
                    <div class="channel-title">${item.channel}</div>
                    <div><small class="video-stats" style="color:#7ed868;font-weight:bold;">` +
                        views +
              `<i class="fa fa-thumbs-up" aria-hidden="true" onclick="print_item('${item.id}')"></i>
                    ${number_format(item.likes)}
                    <span style="color:#DD2726"><i class="fa fa-thumbs-down" aria-hidden="true"></i>${number_format(item.dislikes)}</span>${like_comment}</small></div>
                </div>
              </div>
              </article>
            </div>
          <div style="font-weight:bold; margin-left:20px;margin-top:15px;">
            <span style="color:#ff6b9a;font-size:25px;font-weight:bold">${number_format(obs_recos)}</span> recommendations to this video were observed
          </div>
            <div style="font-weight:bold; margin-left:20px;margin-top:15px;">
            <span style="color:darkblue;font-size:25px;font-weight:bold">${max_local_chans}</span> different channels had recommendations to this video ${days_ago} days ago
          </div>
          <div style="font-weight:bold; margin-left:20px; margin-top: 10px;">
            <span style="color:darkblue;font-size:15px;font-weight:bold">${item['nb_chans_rec']}</span> different channels had recommendations to this video in total
          </div>
        `);
      max_views = 1000000
      for (var i=0;i<item.view_history.length;i++) {
            var days_ago = item.view_history.length - i
            var barHeight= Math.round(150 * item.view_history[i]/max_views)

            if (item.view_history[i] >0) {
                  $('.sink-videos').append(
                  `
                        <div style="height:${barHeight}px; margin:-1px; color: #7ed868;background-color: #7ed868;width:1.5%;display:inline-block" data-balloon-length="large" data-balloon="${days_ago} days ago this video had ${number_format(item.view_history[i])} views">${item.view_history[i]>0 ?'':'?'}</div>
                  `)
            } else {
                  var approx_views = approximateViews(item.view_history, i)
                  barHeight = Math.round(150 * approx_views/max_views)
                  $('.sink-videos').append(
                  `
                        <div style="height:${barHeight}px; margin:-1px; color: #dcf5d6;background-color: #dcf5d6;width:1.5%;display:inline-block" data-balloon-length="large" data-balloon="${days_ago} days ago this video had around ${approx_views>0 ? number_format(approx_views): 'unknown '} views (interpollated number)"></div>
                  `)
            }
      }
      $('.sink-videos').append(
      `
            <div style="margin-top:0px;margin-bottom:15px; margin-left:10px;font-weight: bold; font-style:italic;text-align:center;border-top-style: solid;border-width: 1px;margin-top: -5px;border-color: #7ed868;"> Cummulative number of views in the last 60 days </div>
      `)

      for (var i=0;i<item.reco_history.length;i++) {
            var days_ago = item.reco_history.length - i
            var barHeight= Math.round(150 * item.reco_history[i]/max_recos)
            $('.sink-videos').append(
            `
                  <div style="height:${barHeight}px; margin:-1px; background-color: #ff6b9a;width:1.5%;display:inline-block" data-balloon-length="large" data-balloon="${days_ago} days ago this video was recommended at least ${number_format(item.reco_history[i])} times"></div>
            `)
      }
      $('.sink-videos').append(
      `
            <div style="margin-top:0px;margin-bottom:15px; margin-left:10px;font-weight: bold; font-style:italic;text-align:center;border-top-style: solid;border-width: 1px;margin-top: -5px;border-color: darkblue;"> Observed recommendations to this videos in the last 60 days </div>
      `)


      for (var i=0;i<item.chan_history.length;i++) {
            var days_ago = item.chan_history.length - i
            var barHeight= Math.round(150 * item.chan_history[i]/max_chans)
            $('.sink-videos').append(
            `
                  <div style="height:${barHeight}px; margin:-1px; background-color: darkblue;width:1.5%;display:inline-block" data-balloon-length="large" data-balloon="${days_ago} days ago this video was recommended from ${item.chan_history[i]} channels"></div>
            `)
      }
      $('.sink-videos').append(
      `
            <div style="margin-top:0px;margin-bottom:15px; margin-left:10px;font-weight: bold; font-style:italic;text-align:center;border-top-style: solid;border-width: 1px;margin-top: -5px;border-color: darkblue;"> Number of channels that recommended this videos in the last 60 days </div>
      `)


      $('.sink-videos').append(
      `
            <span style="margin-top:10px;font-weight:bold;">Channels with more than 1 million subscribers from which this video was recommended: </span>
      `)

      for (var i=0;i<item.top_chans_rec.length;i++) {
            $('.sink-videos').append(
      `
            <span><a href="https://www.youtube.com/results?search_query=${item.top_chans_rec[i]}">${item.top_chans_rec[i]}</a>,</span>
      `)
      }



      $('.sink-videos').append(
      `
            <div style="margin-bottom:100px;font-weight:bold;"></div><hr>
      `)

  }})
}

function appendSinkHoles() {
  return;
  $('#panel-block-all').addClass('is-active');
  $('.sink-videos').empty()
  $('#presentation').hide()
  $('.video-header').hide()
  $('.videos').hide()
  $('.video-header').show()
  $('.videos').show()

  results_shown = 10
  addSinkHoles(0, results_shown);
};

window.onscroll = function(ev) {
    if ((window.innerHeight + window.pageYOffset) >= document.body.offsetHeight) {
        results_shown = results_shown + 10
        addSinkHoles(results_shown-10, results_shown);
        console.log('SCROLL DETECTED' + results_shown)
    }
};

function hideIntro(){
      $('#intro').hide();
}
            $(document).ready(function() {
                  $('#srch-term').on('input',function(e){
                        appendSinkHoles();
                  });

                  $.get("../data/*", function(data) {
                        console.log('Initialize');
                  });

                  updateDate()
                  var date_input=$('input[name="date"]'); //our date input has the name "date"
                  var container=$('.bootstrap-iso form').length>0 ? $('.bootstrap-iso form').parent() : "body";
                  var options={
                        format: 'mm/dd/yyyy',
                        container: container,
                        todayHighlight: true,
                        startDate: '10-06-2018',
                        autoclose: true,
                  };
                  date_input.datepicker(options).on('changeDate',function(event){
                        console.log('select')
                        updateDate()
                  });
            });
      </script>
</body>